---
layout: post
title: Post to Slack from PowerShell
date: 2015-06-26 16:03:00.000000000 -04:00
type: post
published: true
status: publish
categories:
- DevOps
tags: []
meta:
  _edit_last: '1'
  _syntaxhighlighter_encoded: '1'
  _jetpack_related_posts_cache: a:1:{s:32:"8f6677c9d6b0f903e98ad32ec61f8deb";a:2:{s:7:"expires";i:1457842849;s:7:"payload";a:3:{i:0;a:1:{s:2:"id";i:1491;}i:1;a:1:{s:2:"id";i:1181;}i:2;a:1:{s:2:"id";i:248;}}}}
author:
  login: adminian
  email: ian.philpot@microsoft.com
  display_name: adminian
  first_name: ''
  last_name: ''
---
<p><img src="{{ site.baseurl }}/assets/062615_1602_PosttoSlack1.png" alt="" /></p>
<p>I was working on some reporting/alerting from my deployment and monitoring systems. I want them to talk to me on slack. A lot of the work is done in PowerShell so natrually this is some PoSh code I need... Anyhow I wanted to share...</p>
<p>First you will need to enable Slackbot remote communications. I just went into my teams <strong>Intergrations</strong> and added <strong>Slackbot</strong>. This will generate a URI with a token. Copy that and keep it handy. Here is the simple script to post as Slackbot.</p>
<blockquote><p>
$slackbotUrl = "https://MYSLACKNAME.slack.com/services/hooks/slackbot?token=xxxxxxxxxxxxxxxxxxxxxxxxx"<br />
$channelParam = "&amp;channel=%23general" # %23 is the # sign<br />
$postUrl = $slackbotUrl + $channelParam<br />
$message = "Another Post to Slackbot..."</p>
<p>Invoke-WebRequest -Uri $postUrl -Body $message -Method Post</p></blockquote>
